<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Bowl Game</title>
</head>

<script src="gamePrepController.js"></script>
<script>
    const USER_ID = "user_id"
    // load in list of team objects from local storage
    const teams = JSON.parse(localStorage.getItem("teams"));

    window.onload = () => {
        // populate team selection buttons with actual team names
        const team1Label = document.getElementById("team1RadioLabel");
        team1Label.innerHTML = teams[0].name;
        const team2Label = document.getElementById("team2RadioLabel");
        team2Label.innerHTML = teams[1].name;
    }

    function addUserToTeam(newUser) {
        // add new user to team depending on which button is selected
        if (document.getElementById("team1Radio").checked) {
            teams[0].members.push(newUser);
        }
        else if (document.getElementById("team2Radio").checked) {
            teams[1].members.push(newUser);
        }
    }

    function createUser() {
        // create user based on form input and add their words to the user object
        let user = document.getElementById(USER_ID).value;
        let wordsList = [];
        //loops through nouns entered by user and adds to wordsList
        Array.from(document.getElementsByClassName("nouns")).forEach(
            (element) => wordsList.push(element.value));
        addUserToTeam({username: user, wordsList});

        // clear text fields
        document.getElementById(USER_ID).value = "";
        for (element of document.getElementsByClassName("nouns")) {
            element.value = "";
        }
    }

    function addTextField() {
        const ul = document.getElementById("nounList");
        const li = document.createElement("li");
        li.innerHTML = '<input type="text" class="nouns" placeholder="Person, Place or Thing" value="">';
        ul.appendChild(li);
    }

    function finalizeGamePrep() {
        createUser();
        saveTeams();
    }

</script>

<body>
    <header>
        <h1>The Bowl Game</h1>
        <link href="styles/style.css" rel="stylesheet" type="text/css">
    </header>
    <main>
        <h2>Game Prep</h2>
        <h3>Create a Username:</h3>
        <form>
            <input type="text" id="user_id" placeholder="Username">
            <input type="radio" id="team1Radio" name="teamSelect" value="team1">
            <label for="team1Radio" id="team1RadioLabel">Team #1</label>
            <input type="radio" id="team2Radio" name="teamSelect" value="team2">
            <label for="team2Radio" id="team2RadioLabel">Team #2</label>
            
            <h3>Enter a few nouns:</h3>
            <ul class="no-bullets" id="nounList">
                <li><input type="text" class="nouns" placeholder="Person, Place or Thing" value=""></li>
                <li><input type="text" class="nouns" placeholder="Person, Place or Thing" value=""></li>
                <li><input type="text" class="nouns" placeholder="Person, Place or Thing" value=""></li>
            </ul>
            <button type="button"><a href="#" onclick="addTextField()">One More Noun...</a></button>
        </form>
        <button type="button"><a href="#" onclick="createUser()">Create Another User</a></button>
        <button type="button"><a href="teamSummary.html" onclick="finalizeGamePrep()">Done</a></button>
    </main>
</body>
</html>